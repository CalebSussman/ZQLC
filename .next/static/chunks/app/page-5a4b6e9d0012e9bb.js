(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3169:function(e,r,a){Promise.resolve().then(a.bind(a,6911))},6911:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return l}});var t=a(3827),s=a(4090),d=a(7907),o=a(5922);let n=[{code:"R",name:"Received",description:"Task received and acknowledged"},{code:"D",name:"Delivered",description:"Task delivered or presented"},{code:"F",name:"Filed",description:"Task filed for reference"},{code:"C",name:"Completed",description:"Task fully completed"},{code:"P",name:"Pending",description:"Task pending external action"},{code:"X",name:"Cancelled",description:"Task cancelled"}];function l(){let e=(0,d.useRouter)(),r=(0,s.useRef)(null),[a,l]=(0,s.useState)([]),[c,i]=(0,s.useState)([]),[u,g]=(0,s.useState)([]),[m,b]=(0,s.useState)([]),[p,x]=(0,s.useState)([]),[h,y]=(0,s.useState)(""),[f,v]=(0,s.useState)(null),[k,N]=(0,s.useState)(null),[j,S]=(0,s.useState)(null),[_,w]=(0,s.useState)(null),[C,I]=(0,s.useState)(null),[O,T]=(0,s.useState)(""),[E,F]=(0,s.useState)(""),[P,R]=(0,s.useState)("status"),[A,q]=(0,s.useState)(!1),[J,M]=(0,s.useState)(null);async function U(){let{data:e}=await o.O.from("universes").select("*").order("display_order");l(e||[]);let{data:r}=await o.O.from("task_details").select("*").order("updated_at",{ascending:!1}).limit(10);x(r||[])}async function D(e){let{data:r}=await o.O.from("phyla").select("*").eq("universe_id",e).order("display_order");i(r||[])}async function X(e){let{data:r}=await o.O.from("families").select("*").eq("phylum_id",e).order("display_order");g(r||[])}async function L(e,r,a){let t=o.O.from("groups_with_counts").select("*").eq("universe_id",e).eq("phylum_id",r);a?t.eq("family_id",a):t.is("family_id",null);let{data:s}=await t.order("group_num");b(s||[])}async function z(){if(!f||!k||!j||!O||!E||!h){alert("Please complete all required fields");return}let r=new Date,a=r.toISOString().replace("T","_").replace(/[-:]/g,".").substring(0,16),t="".concat(k.code).concat(j.code).concat((null==_?void 0:_.code)||"","-").concat(O.padStart(2,"0"),".").concat(E.padStart(2,"0")).toUpperCase(),s="".concat(f.code,"-").concat(a,"=").concat(t);try{let{data:a,error:d}=await o.O.from("tasks").insert({code:s,base_code:t,title:h,universe_id:k.id,phylum_id:j.id,family_id:(null==_?void 0:_.id)||null,group_num:parseInt(O),task_num:parseInt(E),priority:3,status:"active",task_timestamp:r.toISOString()}).select().single();if(d)throw d;if(a){await o.O.rpc("create_task_entry",{p_task_id:a.id,p_status_code:f.code,p_note:"Initial entry",p_entry_timestamp:r.toISOString()});let{data:s}=await o.O.from("cards").select("id").eq("status","active").single();s&&await o.O.from("task_cards").insert({task_id:a.id,card_id:s.id}),e.push("/t/".concat(t.toLowerCase()))}}catch(e){console.error("Error creating task:",e),alert("Failed to create task")}}return(0,s.useEffect)(()=>{U()},[]),(0,s.useEffect)(()=>{k&&D(k.id)},[k]),(0,s.useEffect)(()=>{j&&(X(j.id),k&&L(k.id,j.id,null==_?void 0:_.id))},[j,k,_]),(0,t.jsx)("div",{className:"min-h-screen bg-[#F8F7F4] dark:bg-[#0A0A0B] p-8",children:(0,t.jsxs)("div",{className:"max-w-5xl mx-auto",children:[(0,t.jsxs)("div",{className:"mb-8 border-b-2 border-gray-300 dark:border-gray-700 pb-4",children:[(0,t.jsx)("h1",{className:"text-3xl font-mono font-bold text-gray-900 dark:text-gray-100",children:"CREATE NEW TASK"}),(0,t.jsx)("div",{className:"mt-2 h-1 w-32 bg-gradient-to-r from-yellow-400 to-yellow-500"})]}),(0,t.jsx)("div",{className:"mb-8 bg-[#FFF9C4] dark:bg-[#3D3A2B] p-6 rounded-lg",children:(0,t.jsx)("input",{ref:r,type:"text",value:h,onChange:e=>y(e.target.value),placeholder:"[TASK NAME]",className:"w-full text-2xl font-mono bg-transparent border-b-2 border-gray-400 dark:border-gray-600 pb-2 focus:outline-none focus:border-blue-600 placeholder-gray-500"})}),(0,t.jsxs)("div",{className:"mb-8 bg-white dark:bg-gray-900 p-6 rounded-lg border border-gray-300 dark:border-gray-700",children:[(0,t.jsxs)("div",{className:"font-mono text-lg mb-4",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"["}),(0,t.jsx)("span",{className:"text-purple-600 font-bold",children:(null==f?void 0:f.code)||"S"}),(0,t.jsx)("span",{className:"text-gray-500",children:"-"}),(0,t.jsx)("span",{className:"text-blue-600",children:(null==k?void 0:k.code)||"U"}),(0,t.jsx)("span",{className:"text-gray-500",children:"/"}),(0,t.jsx)("span",{className:"text-blue-600",children:(null==j?void 0:j.code)||"P"}),(0,t.jsx)("span",{className:"text-gray-500",children:"/"}),(0,t.jsx)("span",{className:"text-blue-600",children:(null==_?void 0:_.code)||"F"}),(0,t.jsx)("span",{className:"text-gray-500",children:"]-"}),(0,t.jsx)("span",{className:"text-green-600",children:O.padStart(2,"0")||"##"}),(0,t.jsx)("span",{className:"text-gray-500",children:"."}),(0,t.jsx)("span",{className:"text-green-600",children:E.padStart(2,"0")||"##"})]}),f&&k&&j&&O&&E&&(0,t.jsxs)("div",{className:"mt-4 p-3 bg-gray-100 dark:bg-gray-800 rounded",children:[(0,t.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:["Status prefix: ",f.code,"-",new Date().toISOString().replace("T","_").replace(/[-:]/g,".").substring(0,16)]}),(0,t.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:["Core code: ","".concat(k.code).concat(j.code).concat((null==_?void 0:_.code)||"","-").concat(O.padStart(2,"0"),".").concat(E.padStart(2,"0")).toUpperCase()]}),(0,t.jsx)("div",{className:"text-sm font-mono font-bold",children:(()=>{if(!f||!k||!j||!O||!E)return"";let e=new Date().toISOString().replace("T","_").replace(/[-:]/g,".").substring(0,16),r="".concat(k.code).concat(j.code).concat((null==_?void 0:_.code)||"","-").concat(O.padStart(2,"0"),".").concat(E.padStart(2,"0")).toUpperCase();return"".concat(f.code,"-").concat(e,"=").concat(r)})()})]})]}),"status"===P&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-white dark:bg-gray-900 rounded-lg border-2 border-purple-500",children:[(0,t.jsx)("h3",{className:"font-mono font-bold mb-4",children:"Select Status:"}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:n.map(e=>(0,t.jsxs)("button",{onClick:()=>{v(e),R("universe")},className:"p-4 rounded-lg border-2 transition-all hover:scale-105 font-mono ".concat((null==f?void 0:f.code)===e.code?"bg-purple-100 dark:bg-purple-900 border-purple-600":"bg-gray-50 dark:bg-gray-800 border-gray-300 dark:border-gray-700 hover:border-purple-400"),children:[(0,t.jsxs)("div",{className:"text-xl font-bold text-purple-600 dark:text-purple-400",children:["[",e.code,"]"]}),(0,t.jsx)("div",{className:"text-sm mt-1",children:e.name})]},e.code))})]}),"universe"===P&&f&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-white dark:bg-gray-900 rounded-lg border-2 border-blue-500",children:[(0,t.jsx)("h3",{className:"font-mono font-bold mb-4",children:"Select Universe:"}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:a.map(e=>(0,t.jsxs)("button",{onClick:()=>{N(e),R("phylum")},className:"p-4 rounded-lg border-2 transition-all hover:scale-105 font-mono ".concat((null==k?void 0:k.id)===e.id?"bg-blue-100 dark:bg-blue-900 border-blue-600":"bg-gray-50 dark:bg-gray-800 border-gray-300 dark:border-gray-700 hover:border-blue-400"),children:[(0,t.jsx)("div",{className:"text-xl font-bold",children:e.code}),(0,t.jsxs)("div",{className:"text-sm mt-1",children:["(",e.name,")"]})]},e.id))})]}),"phylum"===P&&k&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-white dark:bg-gray-900 rounded-lg border-2 border-blue-500",children:[(0,t.jsx)("h3",{className:"font-mono font-bold mb-4",children:"Select Phylum:"}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:c.map(e=>(0,t.jsxs)("button",{onClick:()=>{S(e),R("family")},className:"p-4 rounded-lg border-2 transition-all hover:scale-105 font-mono ".concat((null==j?void 0:j.id)===e.id?"bg-blue-100 dark:bg-blue-900 border-blue-600":"bg-gray-50 dark:bg-gray-800 border-gray-300 dark:border-gray-700 hover:border-blue-400"),children:[(0,t.jsx)("div",{className:"text-xl font-bold",children:e.code}),(0,t.jsxs)("div",{className:"text-sm mt-1",children:["(",e.name,")"]})]},e.id))})]}),"family"===P&&j&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-white dark:bg-gray-900 rounded-lg border-2 border-yellow-500",children:[(0,t.jsx)("h3",{className:"font-mono font-bold mb-4",children:"Select Family (Optional):"}),(0,t.jsx)("button",{onClick:()=>{w(null),R("group")},className:"w-full mb-3 p-3 text-left font-mono text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700",children:"â†’ Skip to Group (no family)"}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:u.map(e=>(0,t.jsxs)("button",{onClick:()=>{w(e),R("group")},className:"p-4 rounded-lg border-2 transition-all hover:scale-105 font-mono ".concat((null==_?void 0:_.id)===e.id?"bg-yellow-100 dark:bg-yellow-900 border-yellow-600":"bg-gray-50 dark:bg-gray-800 border-gray-300 dark:border-gray-700 hover:border-yellow-400"),children:[(0,t.jsx)("div",{className:"text-xl font-bold",children:e.code}),(0,t.jsxs)("div",{className:"text-sm mt-1",children:["(",e.name,")"]})]},e.id))})]}),"group"===P&&j&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-white dark:bg-gray-900 rounded-lg border-2 border-green-500",children:[(0,t.jsx)("h3",{className:"font-mono font-bold mb-4",children:"Select or Create Group:"}),(0,t.jsxs)("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-3",children:[m.map(e=>(0,t.jsxs)("button",{onClick:()=>{I(e),T(String(e.group_num).padStart(2,"0")),R("task")},className:"p-3 rounded-lg border-2 transition-all hover:scale-105 font-mono ".concat((null==C?void 0:C.group_num)===e.group_num?"bg-green-100 dark:bg-green-900 border-green-600":"bg-gray-50 dark:bg-gray-800 border-gray-300 dark:border-gray-700 hover:border-green-400"),children:[(0,t.jsx)("div",{className:"text-lg font-bold",children:String(e.group_num).padStart(2,"0")}),(0,t.jsx)("div",{className:"text-xs truncate",children:e.name}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:[e.task_count||0," tasks"]})]},"".concat(e.group_num))),(0,t.jsxs)("button",{onClick:()=>{T(String(Math.max(...m.map(e=>e.group_num),-1)+1).padStart(2,"0")),R("task")},className:"p-3 rounded-lg border-2 border-dashed border-gray-400 hover:border-green-400 transition-all font-mono",children:[(0,t.jsx)("div",{className:"text-2xl text-gray-400",children:"+"}),(0,t.jsx)("div",{className:"text-xs",children:"New"})]})]})]}),"task"===P&&O&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-white dark:bg-gray-900 rounded-lg border-2 border-green-500",children:[(0,t.jsx)("h3",{className:"font-mono font-bold mb-4",children:"Enter Task Number:"}),(0,t.jsx)("input",{type:"text",value:E,onChange:e=>F(e.target.value.replace(/\D/g,"").slice(0,2)),placeholder:"##",className:"w-24 px-4 py-3 text-xl font-mono text-center bg-gray-50 dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-700 rounded-lg focus:outline-none focus:border-green-500",maxLength:2}),2===E.length&&(0,t.jsx)("button",{onClick:z,className:"ml-4 px-6 py-3 bg-green-600 text-white font-mono rounded-lg hover:bg-green-700 transition-colors",children:"CREATE TASK"})]}),(0,t.jsxs)("div",{className:"mt-8 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg",children:[(0,t.jsx)("h3",{className:"font-mono font-bold mb-3",children:"Recent Tasks:"}),(0,t.jsx)("div",{className:"space-y-2",children:p.slice(0,5).map(r=>(0,t.jsxs)("div",{onClick:()=>{var a;return e.push("/t/".concat(null===(a=r.base_code)||void 0===a?void 0:a.toLowerCase()))},className:"flex items-center p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded cursor-pointer font-mono text-sm",children:[(0,t.jsx)("span",{className:"text-gray-500",children:">"}),(0,t.jsx)("span",{className:"ml-2 font-bold",children:r.base_code}),(0,t.jsxs)("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:['"',r.title,'"']})]},r.id))})]})]})})}},5922:function(e,r,a){"use strict";a.d(r,{O:function(){return t}});let t=(0,a(7887).eI)("https://ofiindxmfiptivijhbdi.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9maWluZHhtZmlwdGl2aWpoYmRpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgzOTU4MjEsImV4cCI6MjA3Mzk3MTgyMX0.P9Qmhha1EL7X0uQ8CiUF6LXWqBCQt1pJwg3cmcHkfR0")},7907:function(e,r,a){"use strict";var t=a(5313);a.o(t,"useParams")&&a.d(r,{useParams:function(){return t.useParams}}),a.o(t,"usePathname")&&a.d(r,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(r,{useRouter:function(){return t.useRouter}})}},function(e){e.O(0,[887,971,69,744],function(){return e(e.s=3169)}),_N_E=e.O()}]);