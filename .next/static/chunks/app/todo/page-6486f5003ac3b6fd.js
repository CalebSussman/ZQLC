(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[435],{8369:function(e,t,a){Promise.resolve().then(a.bind(a,4445))},4445:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return d}});var s=a(3827),r=a(4090),n=a(7907),l=a(5922);function d(){(0,n.useRouter)();let[e,t]=(0,r.useState)(null),[a,d]=(0,r.useState)([]),[i,c]=(0,r.useState)(null),[o,u]=(0,r.useState)([]),[m,b]=(0,r.useState)(!1),[x,g]=(0,r.useState)(0);async function h(){let{data:e}=await l.O.from("current_card").select("*").single();t(e)}async function p(){if(!e)return;let{data:t}=await l.O.from("card_task_details").select("*").eq("card_id",e.id).order("position");if(t){let e=t.find(e=>e.base_code.startsWith("CCA-01.")&&e.title.toLowerCase().includes("file")),a=t.filter(t=>t!==e);c(e||null),d(a)}}async function f(){let{data:e}=await l.O.from("cards").select("*").eq("status","filed").order("end_date",{ascending:!1}).limit(10);u(e||[])}async function _(e){let t=["R","P","D","F","C","X"],a=(t.indexOf(e.current_status)+1)%t.length,s=t[a];await l.O.rpc("create_task_entry",{p_task_id:e.task_id,p_status_code:s,p_note:"Status changed via todo",p_entry_timestamp:new Date().toISOString()}),p()}async function y(){e&&i&&(await l.O.rpc("create_task_entry",{p_task_id:i.task_id,p_status_code:"C",p_note:"Filed ".concat(e.card_number),p_entry_timestamp:new Date().toISOString()}),await l.O.rpc("file_card",{p_card_id:e.id,p_filing_task_id:i.task_id}),h(),f())}(0,r.useEffect)(()=>{h(),f()},[]),(0,r.useEffect)(()=>{e&&(p(),function(){if(!e)return;let t=new Date(e.start_date);g(Math.ceil(Math.abs(new Date().getTime()-t.getTime())/864e5))}())},[e]);let v=e=>{switch(e){case"C":case"X":return"■";default:return"□"}},k=e=>{switch(e){case"R":return"text-blue-600";case"P":return"text-yellow-600";case"D":return"text-green-600";case"F":return"text-gray-600";case"C":return"text-gray-400 line-through";case"X":return"text-red-400 line-through";default:return""}};return(0,s.jsx)("div",{className:"min-h-screen bg-[#F8F7F4] dark:bg-[#0A0A0B] p-8",children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-8 pb-6 border-b-4 border-gray-900 dark:border-gray-300",children:[(0,s.jsxs)("div",{className:"flex items-baseline justify-between",children:[(0,s.jsxs)("h1",{className:"text-4xl font-mono font-bold",children:["ATOL-",(null==e?void 0:e.card_number)||"..."]}),(0,s.jsxs)("div",{className:"text-sm font-mono text-gray-600 dark:text-gray-400",children:["STARTED ",null==e?void 0:e.start_date," | DAY ",x]})]}),(0,s.jsx)("div",{className:"mt-4 h-2 bg-gray-200 dark:bg-gray-700 rounded",children:(0,s.jsx)("div",{className:"h-full bg-gradient-to-r from-yellow-400 to-yellow-500 rounded",style:{width:"".concat((null==e?void 0:e.completed_tasks)&&(null==e?void 0:e.total_tasks)?e.completed_tasks/e.total_tasks*100:0,"%")}})})]}),(0,s.jsx)("div",{className:"space-y-3 mb-8",children:a.map(e=>(0,s.jsx)("div",{onClick:()=>_(e),className:"p-4 bg-white dark:bg-gray-900 rounded-lg border border-gray-300 dark:border-gray-700 hover:shadow-lg transition-all cursor-pointer font-mono ".concat(k(e.current_status)),children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("span",{className:"text-2xl mr-3",children:v(e.current_status)}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-baseline",children:[(0,s.jsxs)("span",{className:"font-bold text-lg mr-2",children:["[",e.current_status,"]"]}),(0,s.jsx)("span",{className:"font-bold mr-3",children:e.base_code}),(0,s.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:['"',e.title,'"']})]}),"C"===e.current_status&&(0,s.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"(completed)"})]})]})},e.id))}),(0,s.jsx)("div",{className:"mb-8 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg font-mono text-center",children:(0,s.jsxs)("div",{className:"border-t border-b border-gray-400 dark:border-gray-600 py-2",children:[(null==e?void 0:e.total_tasks)||0," TASKS | ",(null==e?void 0:e.completed_tasks)||0," COMPLETE | ",(null==e?void 0:e.pending_tasks)||0," PENDING"]})}),i&&(0,s.jsx)("div",{className:"mb-8 p-6 bg-gradient-to-r from-purple-100 to-purple-200 dark:from-purple-900/20 dark:to-purple-800/20 rounded-lg border-4 border-double border-purple-600",children:(0,s.jsxs)("div",{className:"font-mono text-center",children:[(0,s.jsxs)("div",{className:"text-xl font-bold mb-2",children:[i.base_code,": FILE ATOL-",null==e?void 0:e.card_number," → ",(null==e?void 0:e.card_number)==="XVI"?"XVII":(null==e?void 0:e.card_number)==="XVII"?"XVIII":(null==e?void 0:e.card_number)==="XVIII"?"XIX":(null==e?void 0:e.card_number)==="XIX"?"XX":"XXI"]}),(0,s.jsx)("button",{onClick:y,className:"px-6 py-3 bg-purple-600 text-white font-bold rounded-lg hover:bg-purple-700 transition-colors",children:"[COMPLETE FILING]"})]})}),(0,s.jsxs)("div",{className:"flex justify-between items-center font-mono",children:[(0,s.jsxs)("button",{onClick:()=>{parseInt((null==e?void 0:e.card_number)||"0")},className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100",children:["[<] ATOL-",(null==e?void 0:e.card_number)==="XVII"?"XVI":(null==e?void 0:e.card_number)==="XVIII"?"XVII":"XV"]}),(0,s.jsx)("button",{onClick:()=>b(!m),className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded hover:bg-gray-300 dark:hover:bg-gray-600",children:"[ARCHIVES]"})]}),m&&(0,s.jsxs)("div",{className:"mt-8 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg",children:[(0,s.jsx)("h3",{className:"font-mono font-bold mb-4",children:"Filed Cards:"}),(0,s.jsx)("div",{className:"space-y-2",children:o.map(e=>(0,s.jsxs)("div",{className:"font-mono text-sm",children:[(0,s.jsxs)("span",{className:"font-bold",children:["ATOL-",e.card_number]}),(0,s.jsxs)("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:[e.start_date," → ",e.end_date]}),(0,s.jsxs)("span",{className:"ml-3 text-gray-500",children:["(",e.total_tasks," tasks)"]})]},e.id))})]})]})})}},5922:function(e,t,a){"use strict";a.d(t,{O:function(){return s}});let s=(0,a(7887).eI)("https://ofiindxmfiptivijhbdi.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9maWluZHhtZmlwdGl2aWpoYmRpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgzOTU4MjEsImV4cCI6MjA3Mzk3MTgyMX0.P9Qmhha1EL7X0uQ8CiUF6LXWqBCQt1pJwg3cmcHkfR0")},7907:function(e,t,a){"use strict";var s=a(5313);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})}},function(e){e.O(0,[887,971,69,744],function(){return e(e.s=8369)}),_N_E=e.O()}]);