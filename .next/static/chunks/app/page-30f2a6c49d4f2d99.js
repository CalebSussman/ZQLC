(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3169:function(e,t,r){Promise.resolve().then(r.bind(r,6911))},6911:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var a=r(3827),n=r(4090),o=r(7907),s=r(5922),l=r(6332);let d=[{code:"R",name:"Received",description:"Task received and acknowledged"},{code:"D",name:"Delivered",description:"Task delivered or presented"},{code:"F",name:"Filed",description:"Task filed for reference"},{code:"C",name:"Completed",description:"Task fully completed"},{code:"P",name:"Pending",description:"Task pending external action"},{code:"X",name:"Cancelled",description:"Task cancelled"}];function c(){let e=(0,o.useRouter)(),t=(0,n.useRef)(null),[r,c]=(0,n.useState)([]),[i,u]=(0,n.useState)([]),[g,m]=(0,n.useState)([]),[b,p]=(0,n.useState)([]),[x,h]=(0,n.useState)([]),[f,y]=(0,n.useState)(""),[v,k]=(0,n.useState)(null),[N,j]=(0,n.useState)(null),[S,w]=(0,n.useState)(null),[_,C]=(0,n.useState)(null),[I,T]=(0,n.useState)(null),[O,E]=(0,n.useState)(""),[F,L]=(0,n.useState)(""),[D,P]=(0,n.useState)("status"),[U,R]=(0,n.useState)(""),[A,J]=(0,n.useState)(""),[M,q]=(0,n.useState)(""),[B,X]=(0,n.useState)(""),[z,Z]=(0,n.useState)(!1),[G,Q]=(0,n.useState)(null);async function W(){let{data:e}=await s.O.from("universes").select("*").order("display_order");c(e||[]);let{data:t}=await s.O.from("task_details").select("*").order("updated_at",{ascending:!1}).limit(10);h(t||[])}async function Y(e){let{data:t}=await s.O.from("phyla").select("*").eq("universe_id",e).order("display_order");u(t||[])}async function H(e){let{data:t}=await s.O.from("families").select("*").eq("phylum_id",e).order("display_order");m(t||[])}async function K(e,t,r){let a=s.O.from("groups_with_counts").select("*").eq("universe_id",e).eq("phylum_id",t);r?a.eq("family_id",r):a.is("family_id",null);let{data:n}=await a.order("group_num");p(n||[])}async function V(){if(!v||!N||!S||!O||!F||!f){alert("Please complete all required fields");return}let t=new Date,r=t.toISOString().replace("T","_").replace(/[-:]/g,".").substring(0,16),a="".concat(N.code).concat(S.code).concat((null==_?void 0:_.code)||"","-").concat(O.padStart(2,"0"),".").concat(F.padStart(2,"0")).toUpperCase(),n="".concat(v.code,"-").concat(r,"=").concat(a);try{let{data:r,error:o}=await s.O.from("tasks").insert({code:n,base_code:a,title:f,universe_id:N.id,phylum_id:S.id,family_id:(null==_?void 0:_.id)||null,group_num:parseInt(O),task_num:parseInt(F),priority:3,status:"active",task_timestamp:t.toISOString()}).select().single();if(o)throw o;if(r){await s.O.rpc("create_task_entry",{p_task_id:r.id,p_status_code:v.code,p_note:"Initial entry",p_entry_timestamp:t.toISOString()});let n=new Date,o=(0,l.BT)(n),d=new Date(n.getTime()+6e5),c=(0,l.BT)(d);await s.O.from("calendar_entries").insert({task_code:a,status_code:v.code,work_description:f,date:(0,l.LJ)(n),start_time:o,end_time:c,is_parallel:!1,track_number:1});let{data:i}=await s.O.from("cards").select("id").eq("status","active").single();i&&await s.O.from("task_cards").insert({task_id:r.id,card_id:i.id}),e.push("/t/".concat(a.toLowerCase()))}}catch(e){console.error("Error creating task:",e),alert("Failed to create task")}}return(0,n.useEffect)(()=>{W()},[]),(0,n.useEffect)(()=>{N&&Y(N.id)},[N]),(0,n.useEffect)(()=>{S&&(H(S.id),N&&K(N.id,S.id,null==_?void 0:_.id))},[S,N,_]),(0,n.useEffect)(()=>{let e=e=>{if(e.target&&"INPUT"===e.target.tagName)return;let t=e.key.toUpperCase();if(!v||"status"===D){let e=d.find(e=>e.code===t);if(e){k(e),R(t),P("universe");return}}if(v&&(!N||"universe"===D)){let e=r.find(e=>e.code===t);if(e){j(e),J(t),P("phylum");return}}if(N&&(!S||"phylum"===D)){let e=i.find(e=>e.code===t);if(e){w(e),q(t),P("family");return}}if(S&&(!_||"family"===D)){let e=g.find(e=>e.code===t);if(e){C(e),X(t),P("group");return}}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[v,N,S,_,D,r,i,g]),(0,a.jsx)("div",{className:"min-h-screen bg-[#F8F7F4] dark:bg-[#0A0A0B] p-4 sm:p-8",children:(0,a.jsxs)("div",{className:"max-w-5xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-8 border-b-2 border-gray-300 dark:border-gray-700 pb-4",children:[(0,a.jsx)("h1",{className:"text-3xl font-mono font-bold text-gray-900 dark:text-gray-100",children:"CREATE NEW TASK"}),(0,a.jsx)("div",{className:"mt-2 h-1 w-32 bg-gradient-to-r from-yellow-400 to-yellow-500"})]}),(0,a.jsx)("div",{className:"mb-8 bg-[#FFF9C4] dark:bg-[#3D3A2B] p-4 sm:p-6 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 sm:gap-4",children:[(0,a.jsx)("input",{ref:t,type:"text",value:f,onChange:e=>y(e.target.value),placeholder:"[TASK NAME]",className:"flex-1 min-w-0 text-lg sm:text-2xl font-mono bg-transparent border-b-2 border-gray-400 dark:border-gray-600 pb-2 focus:outline-none focus:border-blue-600 placeholder-gray-500"}),(0,a.jsx)("button",{onClick:V,disabled:!v||!N||!S||!O||!F||!f,className:"flex-shrink-0 px-3 py-2 sm:px-4 sm:py-2 text-xl sm:text-2xl font-mono font-bold bg-green-600 hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:">"})]})}),(0,a.jsxs)("div",{className:"mb-8 bg-white dark:bg-gray-900 p-6 rounded-lg border border-gray-300 dark:border-gray-700",children:[(0,a.jsxs)("div",{className:"font-mono text-lg mb-4 flex items-center",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"["}),(0,a.jsx)("input",{type:"text",value:U||(null==v?void 0:v.code)||"",onChange:e=>{let t=e.target.value.toUpperCase();if(R(t),t){let e=d.find(e=>e.code===t);e&&k(e)}},onFocus:()=>P("status"),onClick:()=>P("status"),className:"w-6 text-purple-600 font-bold bg-transparent border-none focus:outline-none focus:bg-purple-50 dark:focus:bg-purple-900/20 text-center cursor-pointer",placeholder:"S",maxLength:1}),(0,a.jsx)("span",{className:"text-gray-500",children:"-"}),(0,a.jsx)("input",{type:"text",value:A||(null==N?void 0:N.code)||"",onChange:e=>{let t=e.target.value.toUpperCase();if(J(t),t){let e=r.find(e=>e.code===t);e&&j(e)}},onFocus:()=>P("universe"),onClick:()=>P("universe"),className:"w-6 text-blue-600 bg-transparent border-none focus:outline-none focus:bg-blue-50 dark:focus:bg-blue-900/20 text-center cursor-pointer",placeholder:"U",maxLength:1}),(0,a.jsx)("span",{className:"text-gray-500",children:"/"}),(0,a.jsx)("input",{type:"text",value:M||(null==S?void 0:S.code)||"",onChange:e=>{let t=e.target.value.toUpperCase();if(q(t),t){let e=i.find(e=>e.code===t);e&&w(e)}},onFocus:()=>P("phylum"),onClick:()=>P("phylum"),className:"w-6 text-blue-600 bg-transparent border-none focus:outline-none focus:bg-blue-50 dark:focus:bg-blue-900/20 text-center cursor-pointer",placeholder:"P",maxLength:1}),(0,a.jsx)("span",{className:"text-gray-500",children:"/"}),(0,a.jsx)("input",{type:"text",value:B||(null==_?void 0:_.code)||"",onChange:e=>{let t=e.target.value.toUpperCase();if(X(t),t){let e=g.find(e=>e.code===t);e&&C(e)}else C(null)},onFocus:()=>P("family"),onClick:()=>P("family"),className:"w-6 text-blue-600 bg-transparent border-none focus:outline-none focus:bg-blue-50 dark:focus:bg-blue-900/20 text-center cursor-pointer",placeholder:"F",maxLength:1}),(0,a.jsx)("span",{className:"text-gray-500",children:"]-"}),(0,a.jsx)("input",{type:"text",value:O,onChange:e=>E(e.target.value.replace(/\D/g,"").slice(0,2)),onFocus:()=>P("group"),onClick:()=>P("group"),className:"w-8 text-green-600 bg-transparent border-none focus:outline-none focus:bg-green-50 dark:focus:bg-green-900/20 text-center cursor-pointer",placeholder:"##",maxLength:2}),(0,a.jsx)("span",{className:"text-gray-500",children:"."}),(0,a.jsx)("input",{type:"text",value:F,onChange:e=>L(e.target.value.replace(/\D/g,"").slice(0,2)),className:"w-8 text-green-600 bg-transparent border-none focus:outline-none focus:bg-green-50 dark:focus:bg-green-900/20 text-center",placeholder:"##",maxLength:2})]}),v&&N&&S&&O&&F&&(0,a.jsxs)("div",{className:"mt-4 p-3 bg-gray-100 dark:bg-gray-800 rounded",children:[(0,a.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:["Status prefix: ",v.code,"-",new Date().toISOString().replace("T","_").replace(/[-:]/g,".").substring(0,16)]}),(0,a.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:["Core code: ","".concat(N.code).concat(S.code).concat((null==_?void 0:_.code)||"","-").concat(O.padStart(2,"0"),".").concat(F.padStart(2,"0")).toUpperCase()]}),(0,a.jsx)("div",{className:"text-sm font-mono font-bold",children:(()=>{if(!v||!N||!S||!O||!F)return"";let e=new Date().toISOString().replace("T","_").replace(/[-:]/g,".").substring(0,16),t="".concat(N.code).concat(S.code).concat((null==_?void 0:_.code)||"","-").concat(O.padStart(2,"0"),".").concat(F.padStart(2,"0")).toUpperCase();return"".concat(v.code,"-").concat(e,"=").concat(t)})()})]})]}),(!v||"status"===D)&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-white dark:bg-gray-900 rounded-lg border-2 border-purple-500",children:[(0,a.jsx)("h3",{className:"font-mono font-bold mb-4",children:"Select Status:"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:d.map(e=>(0,a.jsxs)("button",{onClick:()=>{k(e),R(e.code),P("universe")},className:"p-4 rounded-lg border-2 transition-all hover:scale-105 font-mono ".concat((null==v?void 0:v.code)===e.code?"bg-purple-100 dark:bg-purple-900 border-purple-600":"bg-gray-50 dark:bg-gray-800 border-gray-300 dark:border-gray-700 hover:border-purple-400"),children:[(0,a.jsxs)("div",{className:"text-xl font-bold text-purple-600 dark:text-purple-400",children:["[",e.code,"]"]}),(0,a.jsx)("div",{className:"text-sm mt-1",children:e.name})]},e.code))})]}),v&&(!N||"universe"===D)&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-white dark:bg-gray-900 rounded-lg border-2 border-blue-500",children:[(0,a.jsx)("h3",{className:"font-mono font-bold mb-4",children:"Select Universe:"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:r.map(e=>(0,a.jsxs)("button",{onClick:()=>{j(e),J(e.code),P("phylum")},className:"p-4 rounded-lg border-2 transition-all hover:scale-105 font-mono ".concat((null==N?void 0:N.id)===e.id?"bg-blue-100 dark:bg-blue-900 border-blue-600":"bg-gray-50 dark:bg-gray-800 border-gray-300 dark:border-gray-700 hover:border-blue-400"),children:[(0,a.jsx)("div",{className:"text-xl font-bold",children:e.code}),(0,a.jsxs)("div",{className:"text-sm mt-1",children:["(",e.name,")"]})]},e.id))})]}),N&&(!S||"phylum"===D)&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-white dark:bg-gray-900 rounded-lg border-2 border-blue-500",children:[(0,a.jsx)("h3",{className:"font-mono font-bold mb-4",children:"Select Phylum:"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:i.map(e=>(0,a.jsxs)("button",{onClick:()=>{w(e),q(e.code),P("family")},className:"p-4 rounded-lg border-2 transition-all hover:scale-105 font-mono ".concat((null==S?void 0:S.id)===e.id?"bg-blue-100 dark:bg-blue-900 border-blue-600":"bg-gray-50 dark:bg-gray-800 border-gray-300 dark:border-gray-700 hover:border-blue-400"),children:[(0,a.jsx)("div",{className:"text-xl font-bold",children:e.code}),(0,a.jsxs)("div",{className:"text-sm mt-1",children:["(",e.name,")"]})]},e.id))})]}),S&&(!_||"family"===D)&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-white dark:bg-gray-900 rounded-lg border-2 border-yellow-500",children:[(0,a.jsx)("h3",{className:"font-mono font-bold mb-4",children:"Select Family (Optional):"}),(0,a.jsx)("button",{onClick:()=>{C(null),X(""),P("group")},className:"w-full mb-3 p-3 text-left font-mono text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700",children:"â†’ Skip to Group (no family)"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:g.map(e=>(0,a.jsxs)("button",{onClick:()=>{C(e),X(e.code),P("group")},className:"p-4 rounded-lg border-2 transition-all hover:scale-105 font-mono ".concat((null==_?void 0:_.id)===e.id?"bg-yellow-100 dark:bg-yellow-900 border-yellow-600":"bg-gray-50 dark:bg-gray-800 border-gray-300 dark:border-gray-700 hover:border-yellow-400"),children:[(0,a.jsx)("div",{className:"text-xl font-bold",children:e.code}),(0,a.jsxs)("div",{className:"text-sm mt-1",children:["(",e.name,")"]})]},e.id))})]}),S&&(!O||"group"===D)&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-white dark:bg-gray-900 rounded-lg border-2 border-green-500",children:[(0,a.jsx)("h3",{className:"font-mono font-bold mb-4",children:"Select or Create Group:"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-3",children:[b.map(e=>(0,a.jsxs)("button",{onClick:()=>{T(e),E(String(e.group_num).padStart(2,"0")),P(null)},className:"p-3 rounded-lg border-2 transition-all hover:scale-105 font-mono ".concat((null==I?void 0:I.group_num)===e.group_num?"bg-green-100 dark:bg-green-900 border-green-600":"bg-gray-50 dark:bg-gray-800 border-gray-300 dark:border-gray-700 hover:border-green-400"),children:[(0,a.jsx)("div",{className:"text-lg font-bold",children:String(e.group_num).padStart(2,"0")}),(0,a.jsx)("div",{className:"text-xs truncate",children:e.name}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[e.task_count||0," tasks"]})]},"".concat(e.group_num))),(0,a.jsxs)("button",{onClick:()=>{E(String(Math.max(...b.map(e=>e.group_num),-1)+1).padStart(2,"0")),P(null)},className:"p-3 rounded-lg border-2 border-dashed border-gray-400 hover:border-green-400 transition-all font-mono",children:[(0,a.jsx)("div",{className:"text-2xl text-gray-400",children:"+"}),(0,a.jsx)("div",{className:"text-xs",children:"New"})]})]})]}),O&&!F&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-white dark:bg-gray-900 rounded-lg border-2 border-green-500",children:[(0,a.jsx)("h3",{className:"font-mono font-bold mb-4",children:"Enter Task Number:"}),(0,a.jsx)("input",{type:"text",value:F,onChange:e=>L(e.target.value.replace(/\D/g,"").slice(0,2)),placeholder:"##",className:"w-24 px-4 py-3 text-xl font-mono text-center bg-gray-50 dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-700 rounded-lg focus:outline-none focus:border-green-500",maxLength:2}),2===F.length&&(0,a.jsx)("button",{onClick:V,className:"ml-4 px-6 py-3 bg-green-600 text-white font-mono rounded-lg hover:bg-green-700 transition-colors",children:"CREATE TASK"})]}),(0,a.jsxs)("div",{className:"mt-8 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-mono font-bold mb-3",children:"Recent Tasks:"}),(0,a.jsx)("div",{className:"space-y-2",children:x.slice(0,5).map(t=>(0,a.jsxs)("div",{onClick:()=>{var r;return e.push("/t/".concat(null===(r=t.base_code)||void 0===r?void 0:r.toLowerCase()))},className:"flex items-center p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded cursor-pointer font-mono text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500",children:">"}),(0,a.jsx)("span",{className:"ml-2 font-bold",children:t.base_code}),(0,a.jsxs)("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:['"',t.title,'"']})]},t.id))})]})]})})}},6332:function(e,t,r){"use strict";function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(r,"-").concat(a)}function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=String(e.getHours()).padStart(2,"0"),r=String(e.getMinutes()).padStart(2,"0");return"".concat(t,":").concat(r)}r.d(t,{BT:function(){return n},LJ:function(){return a}})},5922:function(e,t,r){"use strict";r.d(t,{O:function(){return a}});let a=(0,r(7887).eI)("https://ofiindxmfiptivijhbdi.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9maWluZHhtZmlwdGl2aWpoYmRpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgzOTU4MjEsImV4cCI6MjA3Mzk3MTgyMX0.P9Qmhha1EL7X0uQ8CiUF6LXWqBCQt1pJwg3cmcHkfR0")},7907:function(e,t,r){"use strict";var a=r(5313);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})}},function(e){e.O(0,[887,971,69,744],function(){return e(e.s=3169)}),_N_E=e.O()}]);