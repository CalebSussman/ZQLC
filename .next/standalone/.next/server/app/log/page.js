(()=>{var e={};e.id=19,e.ids=[19],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},9819:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>x,originalPathname:()=>g,pages:()=>c,routeModule:()=>m,tree:()=>l});var a=r(482),s=r(9108),n=r(2563),o=r.n(n),i=r(8300),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);r.d(t,d);let l=["",{children:["log",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,5849)),"/workspaces/ZQLC/app/log/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,6680)),"/workspaces/ZQLC/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9361,23)),"next/dist/client/components/not-found-error"]}],c=["/workspaces/ZQLC/app/log/page.tsx"],g="/log/page",x={require:r,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/log/page",pathname:"/log",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},4443:(e,t,r)=>{Promise.resolve().then(r.bind(r,1255))},1255:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var a=r(5344),s=r(3729),n=r(2829);function o(){let[e,t]=(0,s.useState)(new Date),[r,o]=(0,s.useState)([]),[i,d]=(0,s.useState)([]),[l,c]=(0,s.useState)(!1),[g,x]=(0,s.useState)(!1),[m,u]=(0,s.useState)(!1),[b,h]=(0,s.useState)(null),[y,p]=(0,s.useState)(null),[k,f]=(0,s.useState)(null),[v,j]=(0,s.useState)({x:0,y:0}),[_,N]=(0,s.useState)(null),[w,S]=(0,s.useState)({isDragging:!1,dragType:null,draggedItem:null,startPosition:{x:0,y:0},currentPosition:{x:0,y:0}}),[$,C]=(0,s.useState)(!1),[D,E]=(0,s.useState)(""),[O,P]=(0,s.useState)([]),[T,A]=(0,s.useState)(""),[L,q]=(0,s.useState)("step"),[M,R]=(0,s.useState)(!1),[z,U]=(0,s.useState)(""),[I,Y]=(0,s.useState)(null),[F,X]=(0,s.useState)(!1),W=(0,s.useRef)(null),G=(0,s.useRef)(null);(0,s.useEffect)(()=>{c(!0);let e=()=>x(window.innerWidth<768);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,s.useEffect)(()=>{l&&(Q(),Z())},[e,l]);let Q=async()=>{try{let{data:t,error:r}=await n.O.from("calendar_entries").select("*").eq("date",e.toISOString().split("T")[0]).order("start_time");if(r)throw r;let a=await Promise.all((t||[]).map(async e=>{let{data:t}=await n.O.from("task_details").select("id, code, title, current_status, current_status_name").eq("code",e.task_code).single(),r="";if(t?.id){let{data:e}=await n.O.from("task_entries").select("note, entry_timestamp").eq("task_id",t.id).not("note","is",null).not("note","eq","").order("entry_timestamp",{ascending:!1}).limit(1).single(),{data:a}=await n.O.from("task_notes").select("content, created_at").eq("task_id",t.id).order("created_at",{ascending:!1}).limit(1).single(),s=e?.entry_timestamp?new Date(e.entry_timestamp):null,o=a?.created_at?new Date(a.created_at):null;s&&o?r=s>o?e?.note||"":a?.content||"":s?r=e?.note||"":o&&(r=a?.content||"")}return{...e,status_code:t?.current_status||e.status_code,work_description:r||e.work_description||"",task_info:t}}));o(a)}catch(e){console.error("Error loading entries:",e)}},Z=async()=>{try{let{data:e,error:t}=await n.O.from("task_details").select("*").in("status",["active"]).order("updated_at",{ascending:!1}).limit(50);if(t)throw t;d(e||[])}catch(e){console.error("Error loading tasks:",e)}},B=async e=>{if(!e.trim()){P([]);return}try{let{data:t,error:r}=await n.O.from("task_details").select("*").or(`title.ilike.%${e}%,code.ilike.%${e}%,base_code.ilike.%${e}%`).limit(20);if(r)throw r;P(t||[])}catch(e){console.error("Error searching tasks:",e),P([])}},K=e=>{let[t,r]=e.split(":").map(Number);return 60*t+r},H=e=>`${Math.floor(e/60).toString().padStart(2,"0")}:${(e%60).toString().padStart(2,"0")}`,J=e=>{if(!y||w.isDragging)return 64;let t=Math.abs(e-y);return 0===t?120:1===t?90:2===t?65:40},V=()=>{let e=[];for(let t=7;t<=23;t++){let r=J(t)/4;for(let a=0;a<4;a++){let s=60*t+15*a,n=H(s);e.push({time:n,minutes:s,hour:t,quarter:a,height:r,label:0===a?`${12===t?12:t>12?t-12:t}${t>=12?"PM":"AM"}`:""})}}return e},ee=e=>`${e.status_code}-${e.task_code}`,et=async()=>{X(!0);try{let t=e.toISOString().split("T")[0],{data:s}=await n.O.from("calendar_entries").select("*").eq("date",t).order("start_time"),o=Array.from(new Set(s?.map(e=>e.task_code)||[])),{data:i}=await n.O.from("task_details").select("*").in("base_code",o),d=(i||[]).reduce((e,t)=>(e[t.base_code]=t,e),{}),l={};s?.forEach(e=>{let t=d[e.task_code];if(t){let r=t.universe_name||"Unknown";l[r]||(l[r]={name:r,entries:[]}),l[r].entries.push({...e,taskTitle:t.title,taskCode:t.base_code,fullStatusCode:ee(e)})}});let c=Object.values(l).reduce((e,t)=>e+t.entries.length,0),g=new Set(Object.values(l).flatMap(e=>e.entries.map(e=>e.task_code))).size,x=(0,a.jsxs)("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 rounded-lg p-4 border border-blue-200 dark:border-blue-700",children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:c}),a.jsx("div",{className:"text-sm text-blue-800 dark:text-blue-300 font-mono",children:"Activities"})]}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:g}),a.jsx("div",{className:"text-sm text-blue-800 dark:text-blue-300 font-mono",children:"Tasks"})]}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:Object.keys(l).length}),a.jsx("div",{className:"text-sm text-blue-800 dark:text-blue-300 font-mono",children:"Universes"})]})]})}),0===Object.keys(l).length?a.jsx("div",{className:"text-center py-8",children:a.jsx("div",{className:"text-gray-500 dark:text-gray-400 font-mono",children:"No activities logged for this date"})}):Object.entries(l).map(([e,t])=>{let r={Work:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-700",Personal:"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-700",Home:"bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-700"}[e]||"bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700";return(0,a.jsxs)("div",{className:`rounded-lg p-4 border ${r}`,children:[a.jsx("h3",{className:"font-mono font-bold text-lg mb-3",children:e.toUpperCase()}),a.jsx("div",{className:"space-y-2",children:t.entries.map((e,t)=>{let r=e.end_time?`${e.start_time} - ${e.end_time}`:`${e.start_time} (ongoing)`,s={R:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300",P:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300",D:"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300",C:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300",F:"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300",X:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"}[e.status_code]||"bg-gray-100 text-gray-800";return(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded p-3 border border-gray-200 dark:border-gray-700",children:[a.jsx("div",{className:"flex items-start justify-between mb-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:`px-2 py-1 rounded text-xs font-mono ${s}`,children:["[",e.fullStatusCode,"]"]}),a.jsx("span",{className:"font-mono text-sm text-gray-600 dark:text-gray-400",children:r})]})}),a.jsx("div",{className:"font-medium",children:e.taskTitle}),e.work_description&&e.work_description!==e.taskTitle&&a.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.work_description})]},t)})}),(0,a.jsxs)("div",{className:"mt-3 text-sm text-gray-600 dark:text-gray-400 font-mono",children:[t.entries.length," activities in ",e]})]},e)}),(0,a.jsxs)("div",{className:"text-center text-sm text-gray-500 dark:text-gray-400 font-mono",children:["Generated on ",new Date().toLocaleString(),a.jsx("br",{}),"ATOL Semantic Ledger v1.0"]})]});Y(x);let m=er(r);U(m),R(!0)}catch(e){console.error("Error generating SOA:",e)}finally{X(!1)}},er=t=>{let r=new Map;t.forEach(e=>{let t=e.task_code?.substring(0,1)||"Other";r.has(t)||r.set(t,[]),r.get(t)?.push(e)});let a=t.length,s=t.reduce((e,t)=>(e[t.status_code]=(e[t.status_code]||0)+1,e),{}),n=`# Statement of Activities
`;return n+=`## Date: ${e.toLocaleDateString()}

### Summary
- **Total Activities:** ${a}
- **Received:** ${s.R||0}
- **Pending:** ${s.P||0}
- **Delivered:** ${s.D||0}
- **Completed:** ${s.C||0}
- **Cancelled:** ${s.X||0}

`,Array.from(r.entries()).forEach(([e,t])=>{n+=`### ${"W"===e?"Work":"A"===e?"Admin":"C"===e?"Communication":e} Universe

`,t.forEach(e=>{let t=e.end_time?15*Math.round((K(e.end_time)-K(e.start_time))/15):30;n+=`- **${e.task_code}** [${e.status_code}] ${e.work_description} (${e.start_time} - ${e.end_time||"ongoing"}, ${t}m)
`}),n+="\n"}),n+=`
---
Generated on ${new Date().toLocaleString()}
ATOL Semantic Ledger v1.0
`},ea=async(t,r)=>{try{let a=K(r),s=H(Math.min(a+30,1365)),o=t.base_code||t.code.substring(0,20),{error:i}=await n.O.from("calendar_entries").insert({task_code:o,status_code:t.current_status||"P",work_description:t.title,date:e.toISOString().split("T")[0],start_time:r,end_time:s,is_parallel:!1,track_number:1});if(i)throw i;let{error:d}=await n.O.rpc("create_task_entry",{p_task_id:t.id,p_status_code:t.current_status||"P",p_note:`Scheduled: ${r} - ${s} | ${t.title}`,p_entry_timestamp:new Date().toISOString()});if(d)throw d;Q(),C(!1),E(""),P([])}catch(e){console.error("Error creating entry:",e),alert("Failed to create entry: "+e.message)}},es=async(e,t)=>{try{let{data:r}=await n.O.from("calendar_entries").select("*").eq("id",e).single();if(!r)throw Error("Entry not found");let{error:a}=await n.O.from("calendar_entries").update(t).eq("id",e);if(a)throw a;if(t.status_code&&t.status_code!==r.status_code||void 0!==t.work_description&&t.work_description!==r.work_description){let{data:e}=await n.O.from("tasks").select("id").eq("base_code",r.task_code).single();if(e){let a="";t.status_code&&t.status_code!==r.status_code&&(a=`Status changed to ${t.status_code} via calendar`),void 0!==t.work_description&&t.work_description!==r.work_description&&(a&&(a+=" | "),a+=`Note updated via calendar: ${t.work_description||"cleared"}`);let{error:s}=await n.O.rpc("create_task_entry",{p_task_id:e.id,p_status_code:t.status_code||r.status_code,p_note:a,p_entry_timestamp:new Date().toISOString()});if(s&&console.error("Error creating task entry:",s),void 0!==t.work_description&&t.work_description!==r.work_description){let{error:r}=await n.O.from("task_notes").insert({task_id:e.id,type:L,content:t.work_description||"Note cleared via calendar"});r&&console.error("Error creating task note:",r)}}}Q()}catch(e){console.error("Error updating entry:",e),alert("Failed to update entry: "+e.message)}},en=async e=>{try{let{error:t}=await n.O.from("calendar_entries").delete().eq("id",e);if(t)throw t;Q(),N(null)}catch(e){console.error("Error deleting entry:",e),alert("Failed to delete entry: "+e.message)}},eo=(e,t,r)=>{if(e.preventDefault(),e.stopPropagation(),S({isDragging:!0,dragType:r,draggedItem:t,startPosition:{x:e.clientX,y:e.clientY},currentPosition:{x:e.clientX,y:e.clientY}}),G.current){let a=G.current;a.style.display="block",a.style.left=`${e.clientX+10}px`,a.style.top=`${e.clientY+10}px`,a.textContent="task"===r?`${t.code} - ${t.title}`:`${t.task_code} (${t.start_time})`}},ei=e=>{if(w.isDragging&&(S(t=>({...t,currentPosition:{x:e.clientX,y:e.clientY}})),G.current&&(G.current.style.left=`${e.clientX+10}px`,G.current.style.top=`${e.clientY+10}px`),W.current)){let t=W.current.getBoundingClientRect(),r=e.clientY-t.top,a=V(),s=0,n=null;for(let e of a){if(r>=s&&r<s+e.height){n=e.time;break}s+=e.height}h(n)}},ed=()=>{if(!w.isDragging||!w.draggedItem){el();return}b&&W.current&&"task"===w.dragType&&ea(w.draggedItem,b),el()},el=()=>{S({isDragging:!1,dragType:null,draggedItem:null,startPosition:{x:0,y:0},currentPosition:{x:0,y:0}}),h(null),G.current&&(G.current.style.display="none")};(0,s.useEffect)(()=>{let e=e=>{j({x:e.clientX,y:e.clientY}),w.isDragging&&ei(e)};return document.addEventListener("mousemove",e),w.isDragging&&document.addEventListener("mouseup",ed),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",ed)}},[w.isDragging,b]);let ec=r=>{let a=new Date(e);a.setDate(e.getDate()+("next"===r?1:-1)),t(a)},eg=()=>e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),ex=()=>{let t=e.toLocaleDateString("en-US",{weekday:"long"}),r=e.toLocaleDateString("en-US",{month:"long"}),a=e.getDate(),s=e.getFullYear();return{weekday:t,month:r,dayYear:`${a}, ${s}`}},em=e=>{switch(e){case"R":return"bg-blue-500";case"P":return"bg-yellow-500";case"D":return"bg-purple-500";case"C":return"bg-green-500";case"F":return"bg-gray-500";case"X":return"bg-red-500";default:return"bg-gray-400"}};return l?(0,a.jsxs)("div",{className:"min-h-screen bg-[#F8F7F4] dark:bg-[#0A0A0B]",children:[a.jsx("div",{className:"border-b-2 border-gray-900 dark:border-gray-300 p-4",children:a.jsx("div",{className:"font-mono",children:g?(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"text-sm font-bold flex-1 leading-tight",children:[a.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:ex().weekday}),a.jsx("div",{className:"text-base",children:ex().month}),a.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:ex().dayYear})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-1",children:[a.jsx("button",{onClick:()=>t(new Date),className:"px-3 py-1 bg-gray-200 dark:bg-gray-700 rounded hover:bg-gray-300 dark:hover:bg-gray-600 text-xs font-mono",children:"TODAY"}),(0,a.jsxs)("div",{className:"flex space-x-1",children:[a.jsx("button",{onClick:()=>ec("prev"),className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded hover:bg-gray-300 dark:hover:bg-gray-600 text-sm",children:"<"}),a.jsx("button",{onClick:()=>ec("next"),className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded hover:bg-gray-300 dark:hover:bg-gray-600 text-sm",children:">"})]})]}),a.jsx("div",{className:"w-px h-12 bg-gray-400 mx-2"}),(0,a.jsxs)("div",{className:"flex flex-col space-y-1",children:[a.jsx("button",{onClick:()=>u(!m),className:`px-2 py-1 rounded text-xs font-mono transition-colors ${m?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:"TASKS"}),a.jsx("button",{onClick:et,disabled:F,className:"px-2 py-1 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded text-xs font-mono transition-colors",children:F?"GEN...":"SOA"})]})]})]}):(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-xl font-bold",children:eg()}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>ec("prev"),className:"px-3 py-1 bg-gray-200 dark:bg-gray-700 rounded hover:bg-gray-300 dark:hover:bg-gray-600",children:"[<]"}),a.jsx("button",{onClick:()=>t(new Date),className:"px-3 py-1 bg-gray-200 dark:bg-gray-700 rounded hover:bg-gray-300 dark:hover:bg-gray-600 text-xs",children:"TODAY"}),a.jsx("button",{onClick:()=>ec("next"),className:"px-3 py-1 bg-gray-200 dark:bg-gray-700 rounded hover:bg-gray-300 dark:hover:bg-gray-600",children:"[>]"}),a.jsx("div",{className:"w-px h-6 bg-gray-400 mx-2"}),a.jsx("button",{onClick:()=>u(!m),className:`px-3 py-1 rounded text-xs font-mono transition-colors ${m?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:"[TASKS]"}),a.jsx("button",{onClick:et,disabled:F,className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded text-xs font-mono transition-colors",children:F?"[GENERATING...]":"[SOA]"})]})]})})}),(0,a.jsxs)("div",{className:"flex",children:[m&&a.jsx("div",{className:`${g?"fixed inset-0 z-40 bg-black/50":"w-80"}`,children:(0,a.jsxs)("div",{className:`bg-white dark:bg-gray-900 h-full border-r border-gray-300 dark:border-gray-700 p-4 overflow-y-auto ${g?"w-80 shadow-xl":""}`,children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-mono font-bold",children:"Available Tasks"}),g&&a.jsx("button",{onClick:()=>u(!1),className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[i.map(e=>(0,a.jsxs)("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 cursor-move hover:shadow-md transition-shadow",onMouseDown:t=>eo(t,e,"task"),children:[a.jsx("div",{className:"font-mono font-bold text-sm",children:e.display_code||e.base_code||e.code}),a.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.title}),e.current_status&&(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Status: ",e.current_status]})]},e.id)),0===i.length&&a.jsx("div",{className:"text-center text-gray-500 py-8",children:"No active tasks found"})]})]})}),a.jsx("div",{className:"flex-1 p-4",children:a.jsx("div",{className:"relative",children:(0,a.jsxs)("div",{ref:W,className:"relative bg-white dark:bg-gray-900 rounded-lg border border-gray-300 dark:border-gray-700 overflow-hidden",onMouseLeave:()=>{h(null),f(null),p(null)},children:[V().map(e=>(0,a.jsxs)("div",{className:`relative border-b transition-all duration-300 ease-out ${0===e.quarter?"border-gray-400 dark:border-gray-500":"border-gray-100 dark:border-gray-800"} ${b===e.time&&w.isDragging?"bg-blue-50 dark:bg-blue-900/20":""} ${w.isDragging?"":"hover:bg-gray-50 dark:hover:bg-gray-800/50"}`,style:{height:`${e.height}px`},onMouseEnter:()=>{w.isDragging||(h(e.time),p(e.hour))},onClick:()=>{w.isDragging||(A(e.time),C(!0))},children:[e.label&&a.jsx("div",{className:"absolute right-2 top-1 text-xs font-mono text-gray-500 z-20",children:e.label}),a.jsx("div",{className:"absolute left-2 top-0 w-4 h-px bg-gray-300 dark:bg-gray-600 z-20"}),b===e.time&&w.isDragging&&a.jsx("div",{className:"absolute inset-x-2 inset-y-1 border-2 border-dashed border-blue-400 dark:border-blue-500 rounded bg-blue-50 dark:bg-blue-900/20 z-10"}),!w.isDragging&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity",children:a.jsx("div",{className:"text-xs text-gray-400 font-mono",children:"+ Add task"})})]},e.time)),(()=>{let e=[];return r.forEach(t=>{let r=K(t.start_time),a=t.end_time?K(t.end_time):r+60,s=!1;for(let n of e)if(n.some(e=>{let t=K(e.start_time);return r<(e.end_time?K(e.end_time):t+60)&&a>t})){n.push(t),s=!0;break}s||e.push([t])}),e.flatMap(e=>{let t=e.length;return e.map((e,r)=>{let s=K(e.start_time),n=e.end_time?K(e.end_time):s+60,o=0,i=V();for(let e of i){if(e.minutes>=s)break;o+=e.height}let d=0;for(let e of i)e.minutes>=s&&e.minutes<n&&(d+=e.height);let l=Math.floor((window.innerWidth<768?window.innerWidth-70:(W.current?.clientWidth||800)-60)/t)-4,c={top:`${o}px`,height:`${Math.max(d-4,20)}px`,left:`${50+r*(l+4)}px`,width:`${l}px`};return a.jsx("div",{className:`absolute transition-all duration-200 cursor-pointer hover:opacity-80 rounded ${em(e.status_code)} ${k?.id===e.id?"ring-2 ring-white ring-opacity-50":""}`,style:{...c,zIndex:30,margin:"2px"},onMouseEnter:()=>{f(e)},onMouseLeave:()=>f(null),onClick:t=>{t.preventDefault(),t.stopPropagation(),N(e)},children:a.jsx("div",{className:`absolute inset-0 flex items-center transition-all duration-200 ${k?.id===e.id?"justify-end pr-4":"justify-center"}`,children:(0,a.jsxs)("div",{className:"text-xs text-white text-center",children:[(0,a.jsxs)("div",{className:"font-mono font-bold truncate",children:["[",e.status_code,"] ",e.task_code]}),e.task_info?.title&&a.jsx("div",{className:"opacity-90 text-xs truncate font-medium",children:e.task_info.title}),(0,a.jsxs)("div",{className:"opacity-75 text-xs",children:[e.start_time," - ",e.end_time||"ongoing"]})]})})},e.id)})})})(),!w.isDragging&&0===r.length&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-400 pointer-events-none",children:(0,a.jsxs)("div",{className:"text-center font-mono",children:[a.jsx("div",{children:"Drag tasks from panel to schedule"}),a.jsx("div",{className:"text-sm mt-1",children:"Or click time slots to search tasks"})]})})]})})})]}),a.jsx("div",{ref:G,className:"fixed z-50 bg-blue-600 text-white px-2 py-1 rounded shadow-lg font-mono text-sm pointer-events-none",style:{display:"none"}}),k&&(0,a.jsxs)("div",{className:"fixed z-40 bg-gray-900 text-white p-4 rounded-lg shadow-2xl border border-gray-700 font-mono text-sm max-w-sm",style:{left:`${v.x+15}px`,top:`${v.y+15}px`,pointerEvents:"none"},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("div",{className:`w-4 h-4 rounded ${em(k.status_code)}`}),(0,a.jsxs)("div",{className:"font-bold text-yellow-400",children:["[",k.status_code,"] ",k.task_code]})]}),k.task_info?.title&&(0,a.jsxs)("div",{className:"mb-3 pb-2 border-b border-gray-700",children:[a.jsx("div",{className:"text-gray-400 text-xs mb-1",children:"Task:"}),a.jsx("div",{className:"text-xs text-white font-medium",children:k.task_info.title})]}),(0,a.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-400",children:"Start:"}),a.jsx("span",{children:k.start_time})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-400",children:"End:"}),a.jsx("span",{children:k.end_time||"Not set"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-400",children:"Duration:"}),a.jsx("span",{children:k.end_time?`${K(k.end_time)-K(k.start_time)} min`:"Unknown"})]})]}),k.work_description&&(0,a.jsxs)("div",{className:"mt-3 pt-2 border-t border-gray-700",children:[a.jsx("div",{className:"text-gray-400 text-xs mb-1",children:"Work Notes:"}),a.jsx("div",{className:"text-xs text-gray-200",children:k.work_description})]}),a.jsx("div",{className:"mt-3 pt-2 border-t border-gray-700 text-xs text-gray-500",children:"Click to edit"})]}),$&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg w-full max-w-2xl max-h-96 flex flex-col",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:["Schedule task at ",T," on ",e.toLocaleDateString()]}),a.jsx("input",{type:"text",placeholder:"Search existing tasks...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0,value:D,onChange:e=>{E(e.target.value),B(e.target.value)},onKeyDown:e=>{"Escape"===e.key&&(C(!1),E(""),P([])),"Enter"===e.key&&O.length>0&&ea(O[0],T)}})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[D&&0===O.length&&(0,a.jsxs)("div",{className:"p-4 text-center text-gray-500",children:['No tasks found matching "',D,'"']}),O.length>0&&a.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:O.map((e,t)=>(0,a.jsxs)("button",{onClick:()=>ea(e,T),className:"w-full text-left p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[(0,a.jsxs)("div",{className:"font-mono font-bold",children:[e.display_code||e.base_code||e.code," - ",e.title]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:[e.universe_name||"Unknown"," > ",e.phylum_name||"Unknown"]}),0===t&&a.jsx("div",{className:"text-xs text-blue-500 mt-1",children:"Press Enter to select"})]},e.id))}),!D&&(0,a.jsxs)("div",{className:"p-4 text-gray-500 text-sm",children:[a.jsx("p",{children:"Type to search for existing tasks to schedule"}),a.jsx("p",{className:"mt-2",children:"• Search by task title, code, or identifier"}),a.jsx("p",{children:"• Press Enter to select first result"}),a.jsx("p",{children:"• Press ESC to cancel"})]})]}),a.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 flex justify-end",children:a.jsx("button",{onClick:()=>{C(!1),E(""),P([])},className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors",children:"Cancel"})})]})}),_&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg w-full max-w-md",children:[a.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:a.jsx("h3",{className:"font-mono font-bold",children:"Edit Entry"})}),(0,a.jsxs)("div",{className:"p-4 space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-mono mb-1",children:"Task Code"}),a.jsx("div",{className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 font-mono",children:_.task_code}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Task code cannot be changed"})]}),_.task_info?.title&&(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-mono mb-1",children:"Task Title"}),a.jsx("div",{className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400",children:_.task_info.title}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Task title cannot be changed"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-mono mb-1",children:"Start Time"}),a.jsx("input",{type:"time",value:_.start_time,onChange:e=>N({..._,start_time:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-mono mb-1",children:"End Time"}),a.jsx("input",{type:"time",value:_.end_time||"",onChange:e=>N({..._,end_time:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-mono mb-2",children:"Work Notes"}),(0,a.jsxs)("div",{className:"flex gap-2 mb-3",children:[a.jsx("button",{onClick:()=>q("task"),className:`px-3 py-1 rounded text-xs ${"task"===L?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:"Task Note"}),a.jsx("button",{onClick:()=>q("step"),className:`px-3 py-1 rounded text-xs ${"step"===L?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:"Step Note"}),a.jsx("button",{onClick:()=>q("outcome"),className:`px-3 py-1 rounded text-xs ${"outcome"===L?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:"Outcome Note"})]}),a.jsx("textarea",{value:_.work_description,onChange:e=>N({..._,work_description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800",rows:3,placeholder:`Add a ${L} note...`})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-mono mb-2",children:"Status"}),a.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{code:"R",name:"Received",color:"bg-blue-500"},{code:"P",name:"Pending",color:"bg-yellow-500"},{code:"D",name:"Delivered",color:"bg-purple-500"},{code:"C",name:"Completed",color:"bg-green-500"},{code:"F",name:"Filed",color:"bg-gray-500"},{code:"X",name:"Cancelled",color:"bg-red-500"}].map(e=>(0,a.jsxs)("button",{onClick:()=>N({..._,status_code:e.code}),className:`p-2 rounded text-xs font-mono text-white transition-opacity ${e.color} ${_.status_code===e.code?"opacity-100":"opacity-50"}`,children:["[",e.code,"] ",e.name]},e.code))})]})]}),(0,a.jsxs)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 flex gap-2",children:[a.jsx("button",{onClick:()=>{es(_.id,{status_code:_.status_code,work_description:_.work_description,start_time:_.start_time,end_time:_.end_time}),N(null)},className:"flex-1 bg-blue-600 text-white py-2 rounded hover:bg-blue-700 transition-colors font-mono",children:"Save"}),a.jsx("button",{onClick:()=>{confirm("Delete this entry?")&&en(_.id)},className:"flex-1 bg-red-600 text-white py-2 rounded hover:bg-red-700 transition-colors font-mono",children:"Delete"}),a.jsx("button",{onClick:()=>N(null),className:"flex-1 bg-gray-500 text-white py-2 rounded hover:bg-gray-600 transition-colors font-mono",children:"Cancel"})]})]})}),M&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-2 sm:p-4",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg w-full max-w-4xl max-h-[95vh] sm:max-h-[90vh] flex flex-col",children:[a.jsx("div",{className:"p-4 sm:p-6 border-b border-gray-200 dark:border-gray-700",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg sm:text-xl font-mono font-bold",children:"Statement of Activities"}),a.jsx("div",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400 mt-1 font-mono",children:eg()})]}),a.jsx("button",{onClick:()=>R(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 text-xl",children:"✕"})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6",children:I}),(0,a.jsxs)("div",{className:"p-4 sm:p-6 border-t border-gray-200 dark:border-gray-700 flex flex-col sm:flex-row gap-2 sm:gap-3",children:[a.jsx("button",{onClick:()=>{let t=e.toISOString().split("T")[0],r=`SOA-${t}.md`,a=new Blob([z],{type:"text/markdown"}),s=URL.createObjectURL(a),n=document.createElement("a");n.href=s,n.download=r,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(s)},className:"flex-1 bg-green-600 text-white py-3 px-4 rounded hover:bg-green-700 transition-colors font-mono text-xs sm:text-sm",children:"[DOWNLOAD .MD]"}),a.jsx("button",{onClick:()=>{navigator.clipboard.writeText(z),alert("SOA copied to clipboard!")},className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded hover:bg-blue-700 transition-colors font-mono text-xs sm:text-sm",children:"[COPY]"}),a.jsx("button",{onClick:()=>R(!1),className:"flex-1 bg-gray-500 text-white py-3 px-4 rounded hover:bg-gray-600 transition-colors font-mono text-xs sm:text-sm",children:"[CLOSE]"})]})]})})]}):a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:"Loading..."})}},5849:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>n,__esModule:()=>s,default:()=>o});let a=(0,r(6843).createProxy)(String.raw`/workspaces/ZQLC/app/log/page.tsx`),{__esModule:s,$$typeof:n}=a,o=a.default}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[939,704],()=>r(9819));module.exports=a})();